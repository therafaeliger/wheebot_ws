<?xml version="1.0"?>

<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="wheebot">

    <xacro:arg name="is_ignition" default="true" />

    <!-- Include Gazebo Parameters -->
    <xacro:include filename="$(find wheebot_description)/urdf/wheebot_gazebo.xacro" />

    <!-- Include ROS2 Control -->
    <xacro:include filename="$(find wheebot_description)/urdf/wheebot_ros2_control.xacro" />

    <link name="base_footprint"/>

    <link name="base_link">
        <inertial>
            <!-- inertial for wheelchair body -->
            <origin xyz="0 0 0.04" rpy="0 0 0"/>
            <mass value="24.0"/>
            <inertia ixx="0.82" ixy="0.0" ixz="0.0"
                     iyy="1.04" iyz="0.0"
                     izz="1.22"/>
        </inertial>
        <visual>
            <origin rpy="${pi/2} 0 -${pi/2}" xyz="-0.303 0.2158 0.647"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_base_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="${pi/2} 0 -${pi/2}" xyz="-0.303 0.2158 0.647"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_base_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </collision>
    </link>

    <joint name="base_joint" type="fixed">
        <parent link="base_footprint"/>
        <child link="base_link"/>
        <origin rpy="0 0 0" xyz="0 0 0.23"/>
    </joint>

    <link name="wheel_right_link">
        <inertial>
            <!-- inertial for wheelchair main wheels -->
            <origin xyz="0 -0.014 0" rpy="0 0 0"/>
            <mass value="2.5"/>
            <!-- Ixx and Izz are the same for cylinder whose axis is Y -->
            <inertia ixx="0.0572708333" ixy="0.0" ixz="0.0"
                     iyy="0.1125" iyz="0.0"
                     izz="0.0572708333"/>
        </inertial>
        <visual>
            <origin rpy="0 0 -${pi/2}" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_wheel_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
            <!-- <origin rpy="0 0 -${pi/2}" xyz="0 0 0"/> -->
            <origin rpy="${pi/2} 0 0" xyz="0 0 0"/>
            <geometry>
                <!-- <mesh filename="package://wheebot_description/meshes/wheebot_wheel_link.stl" scale="0.001 0.001 0.001"/> -->
                <cylinder length="0.07" radius="0.3"/>
            </geometry>
        </collision>
    </link>

    <joint name="wheel_right_joint" type="continuous">
        <parent link="base_link"/>
        <child link="wheel_right_link"/>
        <axis xyz="0 1 0"/>
        <origin rpy="0 0 0" xyz="-0.151 -0.281 0.062"/>
    </joint>

    <link name="wheel_left_link">
        <inertial>
            <!-- inertial for wheelchair main wheels -->
            <origin xyz="0 0.014 0" rpy="0 0 0"/>
            <mass value="2.5"/>
            <!-- Ixx and Izz are the same for cylinder whose axis is Y -->
            <inertia ixx="0.0572708333" ixy="0.0" ixz="0.0"
                     iyy="0.1125" iyz="0.0"
                     izz="0.0572708333"/>
        </inertial>
        <visual>
            <origin rpy="0 0 ${pi/2}" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_wheel_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
             <!-- <origin rpy="0 0 ${pi/2}" xyz="0 0 0"/> -->
             <origin rpy="${pi/2} 0 0" xyz="0 0 0"/>
            <geometry>
                <!-- <mesh filename="package://wheebot_description/meshes/wheebot_wheel_link.stl" scale="0.001 0.001 0.001"/> -->
                <cylinder length="0.07" radius="0.3"/>
            </geometry>
        </collision>
    </link>

    <joint name="wheel_left_joint" type="continuous">
        <parent link="base_link"/>
        <child link="wheel_left_link"/>
        <axis xyz="0 1 0"/>
        <origin rpy="0 0 0" xyz="-0.151 0.281 0.062"/>
    </joint>

    <link name="fork_right_link">
        <inertial>
            <!-- inertial for caster forks -->
            <origin xyz="0 0 0.0022" rpy="0 0 0" />
            <mass value="0.5" />
            <inertia ixx="0.00094" ixy="0.0" ixz="0.0"
                     iyy="0.00094" iyz="0.0"
                     izz="0.00002"/>
        </inertial>
        <visual>
            <origin rpy="${pi/2} 0 0" xyz="-0.0506 0 -0.15"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_caster_fork_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="${pi/2} 0 0" xyz="-0.0506 0 -0.15"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_caster_fork_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </collision>
    </link>

    <joint name="fork_right_joint" type="continuous">
        <parent link="base_link"/>
        <child link="fork_right_link"/>
        <axis xyz="0 0 1"/>
        <origin rpy="0 0 0" xyz="0.3036 -0.2157 0.003"/>
    </joint>

    <link name="caster_right_link">
        <inertial>
            <!-- inertial for caster wheels -->
            <origin xyz="0 0 0.0022" rpy="0 0 0"/>
            <mass value="0.5"/>
            <!-- Ixx and Izz are the same for cylinder whose axis is Y -->
            <inertia ixx="0.0012875" ixy="0.0" ixz="0.0"
                     iyy="0.0025" iyz="0.0"
                     izz="0.0012875"/>
        </inertial>
        <visual>
            <origin rpy="0 0 -${pi/2}" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_caster_wheel_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
            <!-- <origin rpy="0 0 -${pi/2}" xyz="0 0 0"/> -->
            <origin rpy="${pi/2} 0 0" xyz="0 0 0"/>
            <geometry>
                <!-- <mesh filename="package://wheebot_description/meshes/wheebot_caster_wheel_link.stl" scale="0.001 0.001 0.001"/> -->
                <cylinder length="0.03" radius="0.1"/>
            </geometry>
        </collision>
    </link>

    <joint name="caster_right_joint" type="continuous">
        <parent link="fork_right_link"/>
        <child link="caster_right_link"/>
        <axis xyz="0 1 0"/>
        <origin rpy="0 0 0" xyz="-0.0506 0 -0.15"/>
    </joint>

    <link name="fork_left_link">
        <inertial>
            <!-- inertial for caster forks -->
            <origin xyz="0 0 0.0022" rpy="0 0 0" />
            <mass value="0.5" />
            <inertia ixx="0.00094" ixy="0.0" ixz="0.0"
                     iyy="0.00094" iyz="0.0"
                     izz="0.00002"/>
        </inertial>
        <visual>
            <origin rpy="${pi/2} 0 0" xyz="-0.0506 0 -0.15"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_caster_fork_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="${pi/2} 0 0" xyz="-0.0506 0 -0.15"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_caster_fork_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </collision>
    </link>

    <joint name="fork_left_joint" type="continuous">
        <parent link="base_link"/>
        <child link="fork_left_link"/>
        <axis xyz="0 0 1"/>
        <origin rpy="0 0 0" xyz="0.3036 0.2157 0.003"/>
    </joint>

    <link name="caster_left_link">
        <inertial>
            <!-- inertial for caster wheels -->
            <origin xyz="0 0 0.0022" rpy="0 0 0"/>
            <mass value="0.5"/>
            <!-- Ixx and Izz are the same for cylinder whose axis is Y -->
            <inertia ixx="0.0012875" ixy="0.0" ixz="0.0"
                    iyy="0.0025" iyz="0.0"
                    izz="0.0012875"/>
        </inertial>
        <visual>
            <origin rpy="0 0 -${pi/2}" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/wheebot_caster_wheel_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
        </visual>
        <collision>
            <!-- <origin rpy="0 0 -${pi/2}" xyz="0 0 0"/> -->
            <origin rpy="${pi/2} 0 0" xyz="0 0 0"/>
            <geometry>
                <!-- <mesh filename="package://wheebot_description/meshes/wheebot_caster_wheel_link.stl" scale="0.001 0.001 0.001"/> -->
                <cylinder length="0.03" radius="0.1"/>
            </geometry>
        </collision>
    </link>

    <joint name="caster_left_joint" type="continuous">
        <parent link="fork_left_link"/>
        <child link="caster_left_link"/>
        <axis xyz="0 1 0"/>
        <origin rpy="0 0 0" xyz="-0.0506 0 -0.15"/>
    </joint>

    <link name="imu_link">
        <inertial>
            <origin xyz="-0.00552433659106688 0.000168210391520346 0.000514000497342681" rpy="0 0 0" />
            <mass value="0.000528415362211671" />
            <inertia ixx="1.46176048428261E-08" ixy="1.40015117949421E-10" ixz="-1.99633872937403E-12"
                     iyy="8.59662482954888E-09" iyz="7.52375112767959E-12"
                     izz="2.30279421279312E-08" />
        </inertial>
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/imu_link.STL"/>
            </geometry>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://wheebot_description/meshes/imu_link.STL"/>
            </geometry>
        </collision>
    </link>

    <joint name="imu_joint" type="fixed">
        <origin rpy="0 0 0.07" xyz="0 0 0"/>
        <parent link="base_link"/>
        <child link="imu_link"/>
        <axis xyz="0 0 0"/>
    </joint>

</robot>